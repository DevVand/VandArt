<!DOCTYPE html>
<html>
<head>
    <script>
        navigator.mediaDevices.getUserMedia({ audio: true }).then(function(stream) {
            const audioContext = new AudioContext();
            const analyser = audioContext.createAnalyser();
            const microphone = audioContext.createMediaStreamSource(stream);

            analyser.smoothingTimeConstant = 0.8;
            analyser.fftSize = 1024;
            microphone.connect(analyser);

            setInterval(() => {
                const array = new Uint8Array(analyser.frequencyBinCount);
                analyser.getByteFrequencyData(array);
                let values = 0;
                const length = array.length;

                for (let i = 0; i < length; i++) {
                    values += array[i];
                }

                const average = values / length;
                    console.log(Math.round(average));
                    document.getElementById("lvl").innerHTML = Math.round(average);
                
            }, 5);
        }).catch(function(err) {
            /* handle the error */
        });
    </script>
</head>
<body>
    <center><p id="lvl" style="font-size:200px"></p></center>
</body>
</html>
